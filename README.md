# PPBinding_pred
## Разработка алгоритма, основанного на нейронных сетях, для предсказания аффинности связывания в белок-белковых комплексах.
Для разработки терапевтических и диагностических средств, основанных на работе белок-белковых комплексов, решающее значение имеет надежная информация о силе белковых взаимодействий и их наличии в физиологических и патофизиологических процессах. Наиболее точными являются экспериментальные методы определения силы связывания, однако они имеют ряд ограничений, а также высокую трудоемкость и стоимость. Вычислительные методы способны значительно уменьшить набор потенциальных взаимодействий до подмножества наиболее вероятных, которые послужат отправной точкой для дальнейших лабораторных экспериментов.

В данной работе был разработан алгоритм, основанный на сверточных нейронных сетях, предсказывающий значение константы диссоциации (Kd). 

## Обработка данных
Данные для обучения выбирались на основе базы данных PDBBind v.2020. Список, включающий в себя белок-белковые комплексы, с известными пространственными структурами и константами диссоциации представлен в файле Data/PPComplexes_pKD.xlsx. 1913 комплексов из 2849 имели в своем составе более двух молекул, для них вручную выписывались взаимодействующие цепи, результаты представлены в файле Data/Complexes_chains.csv. В файле Data/Data_files_3.csv представлен список всех структур, для которых проводилась обработка. В связи с невозможностью для части комплексов локализовать область связывания в ячейке, окончательный набор комплексов отличается, в Data/README.md предоставлены ссылки на итоговые обработанный набор данных для train и validation. 

Обработка структурных файлов заключалась в локализации области связывания в 3D ячейку и добавление каналов. Пример обработки для одной структуры показан в файле Data/Prepare_and_cell_finding.ipynb, а также итоговая таблица с атомами, попавшими в ячейку, размером 21х61х61 (Data/1atn.csv) и массив с каналами размера 10х21х61х61 (Data/1atn_neg10.npy).

По итогу добавлены 10 каналов: 

1–4 каналы включают в себя четыре варианта комбинаций атомов. Так, в одном канале акцепторы водородных связей одного белка и доноры другого, во втором канале наоборот, и еще два канала, включающие в себя акцепторы и слабые доноры;

5–6 каналы включают в себя положительно и отрицательно заряженные атомы белков в двух комбинациях;

7 – гидрофобные атомы первого и второго белка;

8 – карбоксильные кислороды обоих белков;

9 – карбоксильные углероды обоих белков;

10 – атомы ароматических соединений.


Скрипт с обработкой всех комплексов представлен в файле Data/Main_prepare.ipynb. Скрипт с отображением распределения целевой метки для всех комплексов представлен в файле Data/Prepare.ipynb.

## Архитектура и гиперпараметры модели

### Архитектура модели:
![image](https://github.com/EABogdanova/PPBinding_pred/assets/126514009/8bd0353f-0182-4dca-b63f-6252a82eec2d)

### Гиперпараметры:
- Оптимизатор AdamW(lr = 0.0001, weight_decay = 0.001);
- Функция потерь MSELoss;
- batch_size = 32
### Метрики качества
- корреляция Пирсона
- RMSE

Архитектура модели, а также функции для аугментации данных представлены в файле Model_and_trainer.py

## Результаты обучения

На протяжении 15 эпох сохраняется лучшая модель, затем для этой модели запускается новый цикл обучения на 15 эпох и также выбирается лучшая, и в конце понижается learning_rate до 0.00001 и производится окончательное обучение на 15 эпохах. Итоговая лучшая модель тестируется на тестовой выборке. Изначально для обучения использовалась метрика RMSE, val отбирался случайно, и каждый объект для обучения в каждой эпохе заново подгружался, затем удалялся. Так, процесс обучения был менее наглядным, так как не было понятно, в какую сторону "ошибается" алгоритм, в правильную или нет, и обучение длилось около 8 часов. Поэтому в последствии обучающая функция была оптимизирована и в качестве метрики включена корреляция Пирсона, так удалось в два раза ускорить обучение (с достижением того же качества предсказания на тестовых данных) и сделать его более наглядным.

#### Этап 1
![image](https://github.com/EABogdanova/PPBinding_pred/assets/126514009/0ab66232-fbad-4f18-9dd1-8e15469bfb1f)

#### Этап 2
![image](https://github.com/EABogdanova/PPBinding_pred/assets/126514009/49316e57-de1e-4c7e-b7f1-1903030d356e)

#### Этап 3
![image](https://github.com/EABogdanova/PPBinding_pred/assets/126514009/f09740b3-215a-41bd-9a82-d0a0340cfbac)

Скрипт для обучения модели представлен в файле Train_Model.ipynb

### Метрики на тестовой выборке:
- Корреляция Пирсона = 0.6
- RMSE = 1.5

![image](https://github.com/EABogdanova/PPBinding_pred/assets/126514009/23a82880-9a5a-4ff0-a9bf-8e9af0c7da99)

### Оценка важности признаков

Был рассчитан разброс весов, внутри каналов, которые в данном случае являются признаками. 
![image](https://github.com/EABogdanova/PPBinding_pred/assets/126514009/2c92a40c-7daa-4bac-be2b-2db17e89ae5d)

Наибольший разброс характерен для канала с ароматическими атомами и акцепторами и донорами водородных связей.

Скрипт для проверки модели на тестовой выборке и определения разброса признаков представлен в файле Test_model.ipynb
