# PPBinding_pred
# Разработка алгоритма, основанного на нейронных сетях, для предсказания аффинности связывания в белок-белковых комплексах.
Для разработки терапевтических и диагностических средств, основанных на работе белок-белковых комплексов, решающее значение имеет надежная информация о силе белковых взаимодействий и их наличии в физиологических и патофизиологических процессах. Наиболее точными являются экспериментальные методы определения силы связывания, однако они имеют ряд ограничений, а также высокую трудоемкость и стоимость. Вычислительные методы способны значительно уменьшить набор потенциальных взаимодействий до подмножества наиболее вероятных, которые послужат отправной точкой для дальнейших лабораторных экспериментов. Целью данной работы является разработка алгоритма, способного предсказывать силу связывания между белками в комплексах, который в дальнейшем может ощутимо сэкономить время и ресурсы при подборе терапевтических мишеней. Для выполнения цели будут решаться следующие задачи:
  1)	Сборка и обработка структурных данных белок-белковых и белок-пептидных комплексов из набора данных PDBBind_v.2020 (http://www.pdbbind.org.cn/index.php) (до конца февраля);
  2)	Подбор оптимального разделения данных на train, val, test (2-3 дня в начале марта);
  3)	Подбор архитектуры и построение нейронной сети для предсказания силы связывания в комплексах (до середины марта);
  4)	Анализ результатов, оптимизация гиперпараметров (вторая половина марта).

Данные

Сборка обучающего датасета будет происходить при использовании белковых баз данных, содержащих информацию о структуре и характеристиках белок-белковых комплексов (Protein Data Bank (PDB), Universal Protein Resource (UniProt), PDBBind). В этих базах данных помимо структурных файлов комплексов содержатся характеристики силы связывания между белками Целью алгоритма будет являться предсказание значения константы диссоциации (Kd), которая обратно пропорциональна силе связывания. Весь набор данных будет состоять из 2800 белок-белковых комплексов и комплексов «белок-пептид», которые будут отобраны из общего набора белок-лигандных комплексов (около 7 тысяч). Обучающий набор данных будет включать в себя 2 тысячи белок-белковых комплексов и 6 тысяч белок-пептидных, итого 8000 объектов. Для валидации будут отобраны 600 белок-белковых комплексов и 700 белок-пептидных (итого 1300), тестовые данные будут состоять из оставшихся 500 комплексов. Для теста будут отбираться комплексы белков, которых нет в обучающих данных в связи с тем, что комплексы для одного белка, даже с мутациями могут быть сильно похожи, что приведет к утечке данных. Еще одной проблемой является наличие структур в основном с сильным связыванием, что может повлиять на обобщаемость полученных результатов для комплексов, сконструированных in silico, например, программой AlphaFold. По возможности, в обучающие данные будут добавляться структуры комплексов, рассчитанных AlphaFold, для которых экспериментально получены константы диссоциации, но экспериментальных структур нет.
Обучение модели будет происходить на данных с координатами атомов белковых комплексов (структурные файлы pdb). 
 
Перед подачей данных на вход алгоритма будет производиться преобразование файлов. Во-первых, по координатам будет конструироваться 3D ячейка, ограничивающая область связывания молекул в комплексе (20х20х50 с разрешением в 1 Ангстрем, по наибольшей протяженности области связывания белков), атомы молекул вне этой ячейки учитываться не будут. Дальше для такой ячейки будут созданы 19 каналов: первые 9 для разных типов атомов, 5 для отражения дополнительных свойств (ароматические атомы, гидрофобность, полярность и т.д.), 1 канал для атомов относящихся к одному белку, 1 для атомов другого белка или пептидного лиганда, 3 канала для обозначения гибридизации. Все эти свойства будут извлекаться из исходного файла с использованием библиотек pybel, tfbio, rdkit. По итогу каждый комплекс будет представлен в виде четырехмерного тензора 19х20х20х50.

Модели

В настоящий момент реализованы алгоритмы, использующие данные об аминокислотной последовательности, а также модели, работающие с пространственными структурами. Наибольшая часть разработок данного наплавления направлены на изучение комплексов «белок-лиганд», и для этой задачи достигнуто достаточно высокое качество предсказания. В 2017 году был реализован алгоритм предсказания связывания в комплексах «белок-лиганд» под названием Pafnucy, основанный на глубоких сверточных нейронных сетях и использующий в качестве обучающих данных PDB-структуры комплексов (Stepniewska-Dziubinska, 2017). По итогу для тестового набора было достигнуто значение корреляции Пирсона, равное 0,78, между предсказанными и экспериментально рассчитанными значениями. В 2019 году был реализован алгоритм, также основанный на глубоких сверточных нейронных сетях DeepAtom, решающий эту же задачу со значением корреляции 0,83 (Li, et al, 2019). Помимо этого, выходили алгоритмы, обученные на других датасетах, обеспечивающие достаточно высокое качество предсказания (Zhang et al, 2019).
Что касается предсказания связывания в комплексах «белок-белок», здесь ситуация гораздо более сложная в связи с тем, что обе молекулы в комплексе высокомолекулярные с большим количеством сложных взаимодействий. В настоящий момент реализованные алгоритмы делятся на две группы: осуществляющие бинарную классификацию по наличию связывания (алгоритм основан на CNN и LSTM) (Asim el al., 2022), и решающие регрессионную задачу, обучаясь на данных об аминокислотной последовательности (Abbasi et al., 2020). В первом случае удалось добиться достаточно высокого качества предсказания (accuracy = 0,93), но результат недостаточно информативен, а во втором точность предсказания достаточно низкая (корреляция Пирсона = 0,44). Таким образом остаётся достаточно большое поле для исследования белок-белковых комплексов, и создания алгоритмов, предсказывающих силу связывания между белками с более высокой точностью.
Все вышеперечисленные аналоги построены на основе искусственных нейронных сетей. Для своего алгоритма я также считаю оптимальным использование нейронных сетей. В качестве модели планируется использовать нейронную сеть, содержащую несколько (скорее всего 3) Conv3D слоя, в конце несколько полносвязных слоев, последний из которых с выходом размера 1 (будет выводиться логарифм константы диссоциации). 

Метрики

Для реализованных моделей будет использоваться в качестве метрики корреляция Пирсона между предсказанным и теоретическим значением KD. В случае проведения классификации вместо регрессии предполагается рассчитывать accuracy, F1-score. В подобных задачах также используются данные метрики для определения качества предсказания, с чем и связан их выбор мной для данной задачи. В случае регрессионной задачи успешным будет получение значения корреляции Пирсона больше 0.55, для классификации accuracy > 0.7. В связи с тем, что на данный момент отсутствуют модели, предсказывающие константу диссоциации по трехмерной структуре белок-белкового комплекса, то целью будет добиться точности предсказания, выше, чем для аминокислотных последовательностей (Abbasi et al., 2020).

Литература

1.	https://ru.wikipedia.org/wiki/Белок-белковые_взаимодействия 
2.	https://en.wikipedia.org/wiki/Protein_complex (основная информация о белок-белковых комплексах)
3.	Kastritis P.L., Bonvin A.M. On the binding affinity of macromolecular interactions: daring to ask why proteins interact // J R Soc Interface. 2012. V. 10. N. 79. (Информация о белковых комплексах и определении связывания в них)
Реализованные модели
1.	Abbasi, W.A., Yaseen, A., Hassan, F.U. et al. ISLAND: in-silico proteins binding affinity prediction using sequence information. BioData Mining 13, 20 (2020).
2.	Asim MN, Ibrahim MA, Malik MI, Dengel A, Ahmed S. ADH-PPI: An attention-based deep hybrid model for protein-protein interaction prediction. iScience. 2022 Sep 21;25(10):105169.
3.	Li, Yanjun & Rezaei, Mohammad & Li, Chenglong & Li, Xiaolin & Wu, Dapeng. (2019). DeepAtom: A Framework for Protein-Ligand Binding Affinity Prediction.
4.	Stepniewska-Dziubinska M.M., Zielenkiewicz P., Siedlecki P. Development and evaluation of a deep learning model for protein-ligand binding affinity prediction. 2017.
5.	Zhang H, Liao L, Saravanan KM, Yin P, Wei Y. 2019. DeepBindRG: a deep learning based method for estimating effective protein–ligand affinity. PeerJ 7:e7362

Базы данных
1.	http://www.pdbbind.org.cn/index.php (база данных белковых комплексов с известными характеристиками связывания)
2.	https://alphafold.ebi.ac.uk/  (ресурс для расчета структур белков по их аминокислотной последовательности)
3.	https://www.rcsb.org/  (база данных со всеми полученными структурами белков, как экспериментальными, так и предсказанными)
